assert(term.isColor(),"colorful terminal is required (use advanced computer/turtle)")assert(http and http.websocket,"http/websocket extension is required")local term=term;local a,b,c=term.setCursorPos,term.write,term.blit;term.setTextColor(colors.lightBlue)term.setBackgroundColor(colors.black)term.clear()a(1,1)print("Enter your nickname (letters/digits, max 12):")term.setTextColor(colors.lime)local d=read()local e=assert(http.websocket("ws://cc-place.herokuapp.com"))local f,g=e.send,string.pack;local h=function(i,...)return f(g("!1<"..i,...),true)end;term.setTextColor(colors.white)term.setBackgroundColor(colors.black)term.clear()local j,k=term.getSize()local l=string.rep(" ",j)for m=1,k do a(1,m)b(l)end;j,k=j-2,k-2;local n=j*k;l=string.rep(" ",j)h("BBBBs1",1,0,j,k,d)local o={[keys.left]=function()return h("B",2)end,[keys.right]=function()return h("B",3)end,[keys.up]=function()return h("B",4)end,[keys.down]=function()return h("B",5)end,[keys.leftShift]=function(p)if p then return end;return h("B",6)end,[keys.leftCtrl]=function(p)if p then return end;return h("B",7)end,[keys.space]=function(p)if p then return end;return h("B",8)end,[keys.leftAlt]=function(p)if p then return end;return h("B",9)end}o[keys.a]=o[keys.left]o[keys.d]=o[keys.right]o[keys.w]=o[keys.up]o[keys.s]=o[keys.down]o[keys.rightShift]=o[keys.leftShift]o[keys.rightCtrl]=o[keys.leftCtrl]o[keys.rightAlt]=o[keys.leftAlt]o[keys.f]=o[keys.leftAlt]local q,r,s,t,u=string.sub,string.unpack,string.format,math.min,math.max;local v={key=function(w,p)local x=o[w]if x then return x(p)end end,websocket_closed=function()return error("WebSocket disconnected",-1)end,websocket_message=function(y,z)a(2,1)local A,m,B,C,D,E,F=r("!1<HHBBc1c1z",q(z,n+1))b(s("X%d Y%d%s",A,m,l))local G=2;for H=1,n,j do local I=q(z,H,H+j-1)a(2,G)c(l,I,I)G=G+1 end;a(t(u(B+2,2),j+1),t(u(C+2,2),k+1))c("X",(E=="7"or E=="f")and"0"or"f",E)a(1,k+2)c(" ",D,D)term.setTextColor(1)b(" "..F..l)end}local unpack,J=unpack,os.pullEvent;while true do local K={J()}local x=v[K[1]]if x then x(unpack(K,2))end end