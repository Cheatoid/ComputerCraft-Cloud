assert(term.isColor(),"colorful terminal is required (use advanced computer/turtle)")assert(http and http.websocket,"http/websocket extension is required")local term=term;local a,b,c=term.setCursorPos,term.write,term.blit;term.setTextColor(colors.lightBlue)term.setBackgroundColor(colors.black)term.clear()a(1,1)print("Enter your nickname (letters/digits, max 12):")term.setTextColor(colors.lime)local d=read()local e=assert(http.websocket("ws://cc-place.herokuapp.com"))local f,g=e.send,string.pack;local h=function(i,...)return f(g("!1<"..i,...),true)end;term.setTextColor(colors.white)term.setBackgroundColor(colors.black)term.clear()local j,k=term.getSize()local l=string.rep(" ",j)for m=1,k do a(1,m)b(l)end;j,k=j-2,k-2;local n=j*k;l=string.rep(" ",j)h("BBBBs1",1,1,j,k,d)local o={[keys.left]=function()return h("B",2)end,[keys.right]=function()return h("B",3)end,[keys.up]=function()return h("B",4)end,[keys.down]=function()return h("B",5)end,[keys.leftShift]=function(p)if p then return end;return h("B",6)end,[keys.leftCtrl]=function(p)if p then return end;return h("B",7)end,[keys.space]=function(p)if p then return end;return h("B",8)end,[keys.leftAlt]=function(p)if p then return end;return h("B",9)end}o[keys.a]=o[keys.left]o[keys.d]=o[keys.right]o[keys.w]=o[keys.up]o[keys.s]=o[keys.down]o[keys.rightShift]=o[keys.leftShift]o[keys.rightCtrl]=o[keys.leftCtrl]o[keys.rightAlt]=o[keys.leftAlt]o[keys.f]=o[keys.leftAlt]local q,r,s,t,u,v,w=string.sub,string.unpack,string.format,math.min,math.max;local x={key=function(y,p)local z=o[y]if z then return z(p)end end,mouse_click=function(A,B,m)if A==2 then v,w=B,m end;if A==1 then return h("B",8)end;if A==3 then return h("B",9)end end,mouse_drag=function(A,B,m)if A==2 and w then if v~=B then h("B",v<B and 2 or 3)v=B end;if w~=m then h("B",w<m and 4 or 5)w=m end end end,mouse_up=function(A)if A==2 then v,w=nil end end,mouse_scroll=function(C)return h("B",C>0 and 7 or 6)end,websocket_closed=function()return error("WebSocket disconnected",-1)end,websocket_message=function(D,E)a(2,1)local B,m,F,G,H,I,J=r("!1<HHBBc1c1z",q(E,n+1))b(s("X%d Y%d%s",B,m,l))local K=2;for L=1,n,j do local M=q(E,L,L+j-1)a(2,K)c(l,M,M)K=K+1 end;a(t(u(F+2,2),j+1),t(u(G+2,2),k+1))c("X",(I=="7"or I=="f")and"0"or"f",I)a(1,k+2)c(" ",H,H)term.setTextColor(1)b(" "..J..l)end}local unpack,N=unpack,os.pullEvent;while true do local O={N()}local z=x[O[1]]if z then z(unpack(O,2))end end